## Start producer and consumers
- Inside the vm open up 4 terminals for 1 producer and 3 consumers.

## 1. Producer
In **terminal-1** start producer
```
kafka-console-producer.sh \
--bootstrap-server localhost:9092 \
--topic topic1
```

## 2. Consumer-1,2,3
In **terminal-2, 3, and 4** start consumer under a group name
```
kafka-console-consumer.sh \
--bootstrap-server localhost:9092 \
--topic topic1 \
--group group1
```

## Generate and consume manually generated messages
3. In ***terminal-1** write messages and observe results from consumer terminals (2,3,4)
```
>message-1
>message-2
>message-3
>message-4
>message-5
>message-6
>message-7
>message-8
>message-9
```

## 4. Consuming behaviour
Messages consumed by each consumer under group1 round robin fashion.



## 5. Close Producer 
**terminal-1** with `Ctrl+C` 

- In order to truncate messages in topic1 delete and re-create topic1 
    
## Producing with data-generator under group1
- Use instructions in this repo to use data generator

https://github.com/erkansirin78/data-generator

`(datagen) [train@localhost data_generator]$ python dataframe_to_kafka.py -t topic1  `

Observe the consumer terminals and see how iris rows consumed by each consumer


## 6. Close three consumer terminals with `Ctrl+C`

## 7. reset consumer group
- First run describe then --dry-run see the result. If it is ok lastly run with --execute
- Describe
```
kafka-consumer-groups.sh \
--bootstrap-server localhost:9092 \
--group group1 \
--describe

GROUP           TOPIC           PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID                                            HOST            CLIENT-ID
group1          topic1          2          432             432             0               consumer-group1-1-f11ee1de-42ce-4d9d-85d5-736799180455 /127.0.0.1      consumer-group1-1
group1          topic1          1          416             416             0               consumer-group1-1-d32fb248-00e9-40e9-97a9-e2c22c986cac /127.0.0.1      consumer-group1-1
group1          topic1          0          559             559             0               consumer-group1-1-3725d3cd-8f1e-42dd-8f64-d1a59e711af6 /127.0.0.1      consumer-group1-1
```
- Dry run
```
kafka-consumer-groups.sh \
--bootstrap-server localhost:9092 \
--topic topic1 \
--group group1 \
--reset-offsets \
--to-earliest \
--dry-run

GROUP                          TOPIC                          PARTITION  NEW-OFFSET
group2                         topic1                         0          0
group2                         topic1                         1          0
group2                         topic1                         2          0
```
- Reset
```
kafka-consumer-groups.sh \
--bootstrap-server localhost:9092 \
--topic topic1 \
--group group1 \
--reset-offsets \
--to-earliest \
--execute 

GROUP                          TOPIC                          PARTITION  NEW-OFFSET
group2                         topic1                         0          0
group2                         topic1                         1          0
group2                         topic1                         2          0
```
## 8. Generate and consume messages generated by data-generator under group2

```
kafka-consumer-groups.sh \
--bootstrap-server localhost:9092 \
--group group2 \
--describe

Consumer group 'group2' has no active members.

GROUP           TOPIC           PARTITION  CURRENT-OFFSET  LOG-END-OFFSET  LAG             CONSUMER-ID     HOST            CLIENT-ID
group2          topic1          1          0               416             416             -               -               -
group2          topic1          0          0               559             559             -               -               -
group2          topic1          2          0               432             432             -               -               -
```


## 9. Delete consumer group 
`  kafka-consumer-groups.sh --bootstrap-server localhost:9092 --delete --group group1 `  


